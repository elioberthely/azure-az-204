
<details> 
    <summary>In this exercise, you build a container image from your application code and push it to Azure Container Registry (ACR) using the Azure CLI. You learn how to prepare your app for containerization, </summary>

1) create an ACR instance, 
2) and store your container image in Azure.

Tasks performed in this exercise:

1) Create an Azure Container Registry resource
2) Build and push an image from a Dockerfile
3) Verify the results
4) Run the image in the Azure Container Registry
</details>


### Create an Azure Container Registry resource

1) Entramos al portal

    https://portal.azure.com/

2) En la parte superior seleccionamos el primer icono   [>_]
        De las opciones que nos aparecen seleccionamos
   ###  Bash

<details>
    <summary>Detalles</summary>
3) Nos aparece una ventana que dice
        Getting Started
                  Seleccionamos No storage account required
        Nos aparece abajo Suscription
                  Seleccionamos Pay As You Go
        Procedemos a dar click en Apply
4)  En la parte inferior aparece la linea de comando corriendose en 
    ### NEGRO Y AMARILLO de lo contrario esta mal
  Nos aparece en esa consola una serie de botones
    Switch to Powershell   Restart  Manage Files  New Session     Editor      Web preview     Setting Help
    ### Damos click en Setting
    ### Seleccionamos Go to Clasic Version
6)  Esperemos a que se cargue todo
    Nos aparece de nuevo elio [~]$
</details>   
   

7)  Creamos un resource group

    ### az group create --location eastus  --name myResourceGroupContainer

<!-- 8) Nos debe devolver una respuesta su creacion -->
<details>
    <summary>8) Nos debe devolver una respuesta su creacion </summary>
{
  "id": "/subscriptions/5030b2c6-f741-4e78-80c0-e30d0/resourceGroups/myResourceGroupContainer",
  "location": "eastus",
  "managedBy": null,
  "name": "myResourceGroupContainer",
  "properties": {
    "provisioningState": "Succeeded"
  },
  "tags": null,
  "type": "Microsoft.Resources/resourceGroups"
}
</details>


9) Creamos 1 variable - sustituimos los nombres por los que creamos

    resourceGroup=myResourceGroupContainer

10) Imprimimos la variable con 
    ### echo $resourceGroup

11) Ejecuta el siguiente comando para crear un registro de contenedores b√°sico.

    az acr create --resource-group myResourceGroup \
    --name myContainerRegistry --sku Basic

    sustituimos la variable queda asi

    ### az acr create --resource-group $resourceGroup --name mycontainerregistry2026 --sku Basic


<!-- 12) Nos regresa una respuesta de su creacion -->
<details> 
    <summary>12) Nos regresa una respuesta de su creacion</summary>
        {
        "adminUserEnabled": false,
        "anonymousPullEnabled": false,
        "autoGeneratedDomainNameLabelScope": "Unsecure",
        "creationDate": "2026-02-02T05:55:07.965367+00:00",
        "dataEndpointEnabled": false,
        "dataEndpointHostNames": [],
        "encryption": {
            "keyVaultProperties": null,
            "status": "disabled"
        },
        "id": "/subscriptions/5030b2c6-f741-e395c2d2d0d0/resourceGroups/myResourceGroupContainer/providers/Microsoft.ContainerRegistry/registries/mycontainerregistry2026",
        "identity": null,
        "location": "eastus",
        "loginServer": "mycontainerregistry2026.azurecr.io",
        "metadataSearch": "Disabled",
        "name": "mycontainerregistry2026",
        "networkRuleBypassOptions": "AzureServices",
        "networkRuleSet": null,
        "policies": {
            "azureAdAuthenticationAsArmPolicy": {
            "status": "enabled"
            },
            "exportPolicy": {
            "status": "enabled"
            },
            "quarantinePolicy": {
            "status": "disabled"
            },
            "retentionPolicy": {
            "days": 7,
            "lastUpdatedTime": "2026-02-02T05:55:19.727420+00:00",
            "status": "disabled"
            },
            "softDeletePolicy": {
            "lastUpdatedTime": "2026-02-02T05:55:19.727475+00:00",
            "retentionDays": 7,
            "status": "disabled"
            },
            "trustPolicy": {
            "status": "disabled",
            "type": "Notary"
            }
        },
        "privateEndpointConnections": [],
        "provisioningState": "Succeeded",
        "publicNetworkAccess": "Enabled",
        "resourceGroup": "myResourceGroupContainer",
        "roleAssignmentMode": "LegacyRegistryPermissions",
        "sku": {
            "name": "Basic",
            "tier": "Basic"
        },
        "status": null,
        "systemData": {
            "createdAt": "2026-02-02T05:55:07.965367+00:00",
            "createdBy": "elioberthely@hotmail.com",
            "createdByType": "User",
            "lastModifiedAt": "2026-02-02T05:55:07.965367+00:00",
            "lastModifiedBy": "elioberthely@hotmail.com",
            "lastModifiedByType": "User"
        },
        "tags": {},
        "type": "Microsoft.ContainerRegistry/registries",
        "zoneRedundancy": "Disabled"
        }
</details> 

13) Este comando crea un archivo llamado Dockerfile 
    Dentro de √©l escribe una sola l√≠nea que indica qu√© imagen de Docker se va a usar.

    echo FROM mcr.microsoft.com/hello-world

    Ese enlace pertenece a Microsoft Container Registry (MCR), que es un registro de im√°genes Docker, no un sitio web con p√°ginas HTML.
    escribe la instrucci√≥n que le dice a Docker que use la imagen hello-world alojada en el Microsoft Container Registry.

    > Dockerfile
        guarda ese texto dentro de un archivo llamado Dockerfile (si ya existe, lo sobrescribe).
    
    ### echo FROM mcr.microsoft.com/hello-world > Dockerfile

14) Ejecute el siguiente comando az acr build, que construye la imagen y, despu√©s de que la imagen se construya correctamente, la env√≠a a su registro. Reemplace myContainerRegistry con el nombre que cre√≥ anteriormente.

15) Ejecuta este comando

    az acr build --image sample/hello-world:v1  \
        --registry myContainerRegistry \
        --file Dockerfile .

    ###  az acr build --image sample/hello-world:v1 --registry mycontainerregistry2026 --file Dockerfile .


<details>
<summary>Explicaci√≥n paso a paso del comando `az acr build`</summary>

1. **`az acr build`**  
    Indica que estamos usando la **herramienta de Azure CLI (`az`)**.  
    `acr build` significa que queremos **construir una imagen directamente en Azure Container Registry**, sin usar Docker local.  
    Esto es √∫til si no quieres instalar Docker localmente o quieres que la construcci√≥n se haga en la nube.

2. **`--image sample/hello-world:v1`**  
    Define **el nombre y la etiqueta (tag) de la imagen** que se va a construir.  
    Formato: `nombre/imagen:tag`  
    - `sample/hello-world` ‚Üí nombre de la imagen  
    - `v1` ‚Üí versi√≥n de la imagen (tag)  
    Despu√©s de la construcci√≥n, la imagen en el registro se llamar√° exactamente as√≠:  
    `myContainerRegistry.azurecr.io/sample/hello-world:v1`

3. **`--registry myContainerRegistry2026`**  
    Especifica **el registro de contenedores de Azure** donde se subir√° la imagen.  
    `myContainerRegistry2026` fue el nombre que le pusimos.

4. **`--file Dockerfile`**  
    Indica el archivo **Dockerfile** que contiene las instrucciones para construir la imagen.  
    Si no se especifica, `az acr build` buscar√≠a un Dockerfile con ese nombre en el directorio actual.  
    Permite que tengas varios Dockerfiles en el mismo proyecto y elijas cu√°l usar.

5. **`.` (punto al final)**  
    Es la **ruta del contexto de construcci√≥n**, es decir, la carpeta donde se encuentran los archivos que Docker necesita copiar a la imagen.  
    Normalmente es el directorio actual.  
    Docker copiar√° todos los archivos necesarios desde esa carpeta al contenedor en construcci√≥n, seg√∫n lo que indique el Dockerfile (`COPY`, `ADD`, etc.).

---

### üîÑ Flujo completo del comando

1. `az acr build` se conecta a tu **registro de Azure**.  
2. Toma el **Dockerfile** que le indicas y los archivos del directorio actual.  
3. Construye la imagen con nombre `sample/hello-world:v1`.  
4. Si todo se construye correctamente, **sube autom√°ticamente la imagen al registro**.  
5. La imagen queda lista para usar en contenedores o servicios de Azure.

</details>



16) Esto devolvio esta respuesta

<details>
        Packing source code into tar to upload...
        Uploading archived source code from '/tmp/build_archive_c8cddf4e016349d891cebe8ed5379cd4.tar.gz'...
        Sending context (20.979 KiB) to registry: mycontainerregistry2026...
        Queued a build with ID: ca1
        Waiting for an agent...
        2026/02/02 06:39:50 Downloading source code...
        2026/02/02 06:39:51 Finished downloading source code
        2026/02/02 06:39:52 Using acb_vol_e156a421-b989-4be4-92dc-72cc0aa8a889 as the home volume
        2026/02/02 06:39:52 Setting up Docker configuration...
        2026/02/02 06:39:52 Successfully set up Docker configuration
        2026/02/02 06:39:52 Logging in to registry: mycontainerregistry2026.azurecr.io
        2026/02/02 06:39:53 Successfully logged into mycontainerregistry2026.azurecr.io
        2026/02/02 06:39:53 Executing step ID: build. Timeout(sec): 28800, Working directory: '', Network: ''
        2026/02/02 06:39:53 Scanning for dependencies...
        2026/02/02 06:39:53 Successfully scanned dependencies
        2026/02/02 06:39:53 Launching container with name: build
        Sending build context to Docker daemon   98.3kB
        Step 1/1 : FROM mcr.microsoft.com/hello-world
        latest: Pulling from hello-world
        1b930d010525: Pulling fs layer
        1b930d010525: Verifying Checksum
        1b930d010525: Download complete
        1b930d010525: Pull complete
        Digest: sha256:92c7f9c92844bbbb5d0a101b22f7c2a7949e40f8ea90c8b3bc396879d95e899a
        Status: Downloaded newer image for mcr.microsoft.com/hello-world:latest
        ---> fce289e99eb9
        Successfully built fce289e99eb9
        Successfully tagged mycontainerregistry2026.azurecr.io/sample/hello-world:v1
        2026/02/02 06:39:54 Successfully executed container: build
        2026/02/02 06:39:54 Executing step ID: push. Timeout(sec): 3600, Working directory: '', Network: ''
        2026/02/02 06:39:54 Pushing image: mycontainerregistry2026.azurecr.io/sample/hello-world:v1, attempt 1
        The push refers to repository [mycontainerregistry2026.azurecr.io/sample/hello-world]
        af0b15c8625b: Preparing
        af0b15c8625b: Pushed
        v1: digest: sha256:92c7f9c92844bbbb5d0a101b22f7c2a7949e40f8ea90c8b3bc396879d95e899a size: 524
        2026/02/02 06:39:56 Successfully pushed image: mycontainerregistry2026.azurecr.io/sample/hello-world:v1
        2026/02/02 06:39:56 Step ID: build marked as successful (elapsed time in seconds: 1.306969)
        2026/02/02 06:39:56 Populating digests for step ID: build...
        2026/02/02 06:39:57 Successfully populated digests for step ID: build
        2026/02/02 06:39:57 Step ID: push marked as successful (elapsed time in seconds: 1.844201)
        2026/02/02 06:39:57 The following dependencies were found:
        2026/02/02 06:39:57 
        - image:
            registry: mycontainerregistry2026.azurecr.io
            repository: sample/hello-world
            tag: v1
            digest: sha256:92c7f9c92844bbbb5d0a101b22f7c2a7949e40f8ea90c8b3bc396879d95e899a
        runtime-dependency:
            registry: mcr.microsoft.com
            repository: hello-world
            tag: latest
            digest: sha256:92c7f9c92844bbbb5d0a101b22f7c2a7949e40f8ea90c8b3bc396879d95e899a
        git: {}
        Run ID: ca1 was successful after 7s
<details>
 

17) Explicacion
 <details>
<summary>Explicaci√≥n detallada del resultado de `az acr build`</summary>

### üìã Contexto
Este es el resultado que devuelve Azure despu√©s de ejecutar el comando `az acr build`, que construye y sube la imagen a tu registro.  
Muestra informaci√≥n sobre **la imagen creada, sus dependencias y el estado final**.

---

### üîç Explicaci√≥n l√≠nea por l√≠nea

1. **Informaci√≥n de la imagen construida (`image`)**
    ```yaml
    - image:
        registry: myContainerRegistry.azurecr.io
        repository: sample/hello-world
        tag: v1
        digest: sha256:92c7f9c92844bbba7949e40f8ea90c8b3bc396879d95e899a
    ```
    a) **registry** ‚Üí `myContainerRegistry.azurecr.io`  
       Registro de contenedores de Azure donde se subi√≥ la imagen.

    b) **repository** ‚Üí `sample/hello-world`  
       Nombre de la imagen dentro del registro.

    c) **tag** ‚Üí `v1`  
       Versi√≥n o etiqueta de la imagen.

    d) **digest** ‚Üí `sha256:...`  
       Identificador √∫nico basado en el contenido de la imagen, √∫til para identificar exactamente esta versi√≥n.

2. **Dependencia de ejecuci√≥n (`runtime-dependency`)**
    ```yaml
      runtime-dependency:
        registry: mcr.microsoft.com
        repository: hello-world
        tag: latest
        digest: sha256:92c7f9c92844bbbb5d0a101b22f7c2a7949e40f8ea90c8b3bc396879d95e899a
    ```
    a) Imagen base usada para construir tu imagen, proveniente de **Microsoft Container Registry (`mcr.microsoft.com`)**.  

    b) **tag: latest** ‚Üí indica que se us√≥ la √∫ltima versi√≥n de la imagen base.

    c) **digest** ‚Üí identificador √∫nico de la imagen base.

3. **Informaci√≥n de Git (`git: {}`)**
    ```yaml
      git: {}
    ```
    a) Aqu√≠ normalmente se mostrar√≠a informaci√≥n del repositorio Git si la construcci√≥n estuviera vinculada a uno.  

    b) `{}` indica que **no se us√≥ Git** en esta construcci√≥n.

4. **Estado final de la construcci√≥n**
    ```text
    Run ID: cf1 was successful after 11s
    ```
    a) **Run ID: cf1** ‚Üí identificador √∫nico de esta ejecuci√≥n.  

    b) **was successful** ‚Üí indica que la construcci√≥n y subida fueron exitosas.  

    c) **after 11s** ‚Üí tiempo que tard√≥ toda la operaci√≥n.

---

### ‚úÖ Resumen
1. Se construy√≥ la imagen `sample/hello-world:v1` en tu registro de Azure.  
2. La imagen usa como base `hello-world` de Microsoft.  
3. Cada imagen tiene un **digest SHA256 √∫nico** que la identifica.  
4. No se us√≥ Git durante la construcci√≥n.  
5. La operaci√≥n fue **exitosa** y tom√≥ 11 segundos.

> En pocas palabras: esto muestra qu√© se cre√≥, de d√≥nde viene la base de la imagen, c√≥mo se identifica y que todo funcion√≥ correctamente.

</details>


18) Verifica los resultados
    
    az acr repository list --name myContainerRegistry2026 --output table

    Result
    ------------------
    sample/hello-world

19) az acr repository show-tags --name myContainerRegistry2026 --repository sample/hello-world --output table

    Result
    --------
    v1

20) 
Aqu√≠ tienes la traducci√≥n al espa√±ol:

**Ejecute la imagen de contenedor `sample/hello-world:v1` desde su registro de contenedores usando el comando `az acr run`. El siguiente ejemplo utiliza `$Registry` para especificar el registro donde se ejecuta el comando.**

    ### az acr run --registry myContainerRegistry2026 --cmd '$Registry/sample/hello-world:v1' /dev/null

21) Devuelve este mensaje

<details>
Queued a run with ID: ca2
Waiting for an agent...
2026/02/02 06:57:34 Alias support enabled for version >= 1.1.0, please see https://aka.ms/acr/tasks/task-aliases for more information.
2026/02/02 06:57:34 Creating Docker network: acb_default_network, driver: 'bridge'
2026/02/02 06:57:34 Successfully set up Docker network: acb_default_network
2026/02/02 06:57:34 Setting up Docker configuration...
2026/02/02 06:57:34 Successfully set up Docker configuration
2026/02/02 06:57:34 Logging in to registry: mycontainerregistry2026.azurecr.io
2026/02/02 06:57:35 Successfully logged into mycontainerregistry2026.azurecr.io
2026/02/02 06:57:35 Executing step ID: acb_step_0. Timeout(sec): 600, Working directory: '', Network: 'acb_default_network'
2026/02/02 06:57:35 Launching container with name: acb_step_0
Unable to find image 'mycontainerregistry2026.azurecr.io/sample/hello-world:v1' locally
v1: Pulling from sample/hello-world
1b930d010525: Pulling fs layer
1b930d010525: Verifying Checksum
1b930d010525: Download complete
1b930d010525: Pull complete
Digest: sha256:92c7f9c92844bbbb5d0a101b22f7c2a7949e40f8ea90c8b3bc396879d95e899a
Status: Downloaded newer image for mycontainerregistry2026.azurecr.io/sample/hello-world:v1
**
Hello from Docker!
This message shows that your installation appears to be working correctly.
**
To generate this message, Docker took the following steps:
 1. The Docker client contacted the Docker daemon.
 2. The Docker daemon pulled the "hello-world" image from the Docker Hub.
    (amd64)
 3. The Docker daemon created a new container from that image which runs the
    executable that produces the output you are currently reading.
 4. The Docker daemon streamed that output to the Docker client, which sent it
    to your terminal.
**
To try something more ambitious, you can run an Ubuntu container with:
 $ docker run -it ubuntu bash
**
Share images, automate workflows, and more with a free Docker ID:
 https://hub.docker.com/
**
For more examples and ideas, visit:
 https://docs.docker.com/get-started/
**
2026/02/02 06:57:36 Successfully executed container: acb_step_0
2026/02/02 06:57:36 Step ID: acb_step_0 marked as successful (elapsed time in seconds: 0.937699)
**
Run ID: ca2 was successful after 3s

</details>